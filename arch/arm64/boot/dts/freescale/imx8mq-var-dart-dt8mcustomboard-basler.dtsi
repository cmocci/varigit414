// SPDX-License-Identifier: (GPL-2.0 OR MIT)
/*
 * Copyright 2017 NXP
 * Copyright 2018-2021 Variscite Ltd.
 */

&csi1_bridge {
	dma-coherent;
	bsl,dma-invalidate;
	fsl,two-8bit-sensor-mode;
	yuv-double-component;
	status = "okay";
};

&csi2_bridge {
	dma-coherent;
	bsl,dma-invalidate;
	fsl,two-8bit-sensor-mode;
	yuv-double-component;
	status = "okay";
};

&mipi_csi_1 {
	#address-cells = <1>;
	#size-cells = <0>;
	rxhs-settle = <0x07>;
	status = "okay";

	/* When the second clock is changed, the link-frequencies entry in
	 * the basler_camera_mipi1_ep node also needs to be updated. */
	assigned-clock-rates = <266000000>, <125000000>, <66000000>;

	port {
		mipi1_sensor_ep: endpoint@0 {
			remote-endpoint = <&basler_camera_mipi1_ep>;

			/* If the following entries are changed, then
			 * the entries in the basler_camera_mipi1_ep node
			 * need to updated too. */
			clock-lanes = <0>;
			data-lanes = <1 2 3 4>;
			pixel-mode = <1>;
		};
	};
};

&mipi_csi_2 {
	#address-cells = <1>;
	#size-cells = <0>;
	rxhs-settle = <0x07>;
	status = "okay";

	/* When the second clock is changed, the link-frequencies entry in
	 * the basler_camera_mipi2_ep node also needs to be updated. */
	assigned-clock-rates = <266000000>, <125000000>, <66000000>;

	port {
		mipi2_sensor_ep: endpoint@0 {
			remote-endpoint = <&basler_camera_mipi2_ep>;

			/* If the following entries are changed, then
			 * the entries in the basler_camera_mipi2_ep node
			 * need to updated too. */
			clock-lanes = <0>;
			data-lanes = <1 2 3 4>;
			pixel-mode = <1>;
		};
	};
};

&i2c2 {
	clock-frequency = <400000>;

	/delete-node/ov5640_mipi1@3c;

	basler_camera_mipi1: basler_camera_mipi@36 {
		compatible = "basler,basler-camera";
		reg = <0x36>;
		status = "okay";

		port {
			basler_camera_mipi1_ep: endpoint {
				remote-endpoint = <&mipi1_sensor_ep>;

				/* IMPORTANT: The following three entries needs to be held
				 * in sync with the information stored in the mipi2_sensor_ep node.
				 */
				data-lanes = <1 2 3 4>;
				clock-lanes = <0>;
				link-frequencies = /bits/ 64 <248000000>;
			};
		};
	};
};

&i2c4 {
	clock-frequency = <400000>;

	/delete-node/ov5640_mipi2@3c;

	basler_camera_mipi2: basler_camera_mipi@36 {
		compatible = "basler,basler-camera";
		reg = <0x36>;
		status = "okay";

		port {
			basler_camera_mipi2_ep: endpoint {
				remote-endpoint = <&mipi2_sensor_ep>;

				/* IMPORTANT: The following three entries needs to be held
				 * in sync with the information stored in the mipi1_sensor_ep node. */
				data-lanes = <1 2 3 4>;
				clock-lanes = <0>;
				link-frequencies = /bits/ 64 <248000000>;
			};
		};
	};
};

&pca6408_1 {
	cam1_pwr_hog {
		gpio-hog;
		gpios = <3 0>;
		output-high;
		line-name = "basler_cam1_pwr";
	};

	cam2_pwr_hog {
		gpio-hog;
		gpios = <3 0>;
		output-high;
		line-name = "basler_cam2_pwr";
	};
};
